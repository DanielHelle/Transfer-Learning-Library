Namespace(root='data/office31', data='Office31', source=['D'], target=['A'], train_resizing='default', val_resizing='default', resize_size=224, scale=[0.08, 1.0], ratio=[0.75, 1.3333333333333333], no_hflip=False, norm_mean=(0.485, 0.456, 0.406), norm_std=(0.229, 0.224, 0.225), arch='resnet50', bottleneck_dim=256, no_pool=False, scratch=False, non_linear=False, trade_off=1.0, batch_size=32, lr=0.003, lr_gamma=0.0003, lr_decay=0.75, momentum=0.9, wd=0.0005, workers=2, epochs=2, iters_per_epoch=500, print_freq=100, seed=0, per_class_eval=False, log='logs/dan/Office31_D2A', phase='train')
/home/daniel/exjobb/Transfer-Learning-Library/examples/domain_adaptation/image_classification/dan.py:40: UserWarning: You have chosen to seed training. This will turn on the CUDNN deterministic setting, which can slow down your training considerably! You may see unexpected behavior when restarting from checkpoints.
  warnings.warn('You have chosen to seed training. '
train_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=PIL.Image.BILINEAR)
)
    RandomHorizontalFlip(p=0.5)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
val_transform:  Compose(
    Compose(
    ResizeImage(size=(256, 256))
    CenterCrop(size=(224, 224))
)
    ToTensor()
    Normalize(mean=(0.485, 0.456, 0.406), std=(0.229, 0.224, 0.225))
)
Downloading image_list
Downloading https://cloud.tsinghua.edu.cn/f/d9bca681c71249f19da2/?dl=1 to data/office31/image_list.zip
0it [00:00, ?it/s]  0%|          | 0/12548 [00:03<?, ?it/s] 65%|######5   | 8192/12548 [00:03<00:00, 52868.54it/s]16384it [00:03, 4638.80it/s]                           
Extracting data/office31/image_list.zip to data/office31
Downloading amazon
Downloading https://cloud.tsinghua.edu.cn/f/edc8d1bba1c740dc821c/?dl=1 to data/office31/amazon.tgz
0it [00:00, ?it/s]  0%|          | 0/20448768 [00:02<?, ?it/s]  0%|          | 8192/20448768 [00:02<08:28, 40182.32it/s]  0%|          | 24576/20448768 [00:02<06:57, 48882.61it/s]  0%|          | 32768/20448768 [00:02<06:12, 54777.22it/s]  0%|          | 65536/20448768 [00:02<03:09, 107599.53it/s]  0%|          | 90112/20448768 [00:03<02:30, 135708.51it/s]  1%|          | 122880/20448768 [00:03<01:56, 175208.10it/s]  1%|          | 147456/20448768 [00:03<01:51, 181496.63it/s]  1%|          | 196608/20448768 [00:03<01:18, 259368.55it/s]  1%|1         | 262144/20448768 [00:03<00:58, 347361.84it/s]  2%|1         | 344064/20448768 [00:03<00:44, 449419.65it/s]  2%|2         | 442368/20448768 [00:03<00:34, 583011.56it/s]  3%|2         | 573440/20448768 [00:03<00:26, 761766.56it/s]  4%|3         | 737280/20448768 [00:03<00:20, 984164.97it/s]  5%|4         | 933888/20448768 [00:04<00:15, 1244091.13it/s]  6%|5         | 1179648/20448768 [00:04<00:12, 1581869.79it/s]  7%|7         | 1482752/20448768 [00:04<00:09, 1987143.76it/s]  9%|9         | 1875968/20448768 [00:04<00:07, 2541209.14it/s] 12%|#1        | 2367488/20448768 [00:04<00:05, 3208683.13it/s] 15%|#4        | 2973696/20448768 [00:04<00:04, 4034333.72it/s] 18%|#8        | 3735552/20448768 [00:04<00:03, 5084904.85it/s] 23%|##2       | 4669440/20448768 [00:04<00:02, 6338304.63it/s] 28%|##7       | 5627904/20448768 [00:04<00:02, 6664646.48it/s] 35%|###4      | 7069696/20448768 [00:05<00:01, 7531789.75it/s] 42%|####1     | 8519680/20448768 [00:05<00:01, 7995701.60it/s] 49%|####8     | 10002432/20448768 [00:05<00:01, 8451494.34it/s] 57%|#####7    | 11657216/20448768 [00:05<00:00, 9332697.89it/s] 64%|######4   | 13123584/20448768 [00:05<00:00, 9298474.25it/s] 72%|#######2  | 14770176/20448768 [00:05<00:00, 9291606.50it/s] 79%|#######9  | 16187392/20448768 [00:06<00:00, 9176982.14it/s] 86%|########6 | 17612800/20448768 [00:06<00:00, 9221734.10it/s] 93%|#########3| 19030016/20448768 [00:06<00:00, 9123294.23it/s]20455424it [00:06, 3196245.56it/s]                              
Extracting data/office31/amazon.tgz to data/office31
Downloading dslr
Downloading https://cloud.tsinghua.edu.cn/f/ca6df562b7e64850ad7f/?dl=1 to data/office31/dslr.tgz
0it [00:00, ?it/s]  0%|          | 0/36198413 [00:02<?, ?it/s]  0%|          | 8192/36198413 [00:02<17:01, 35429.86it/s]  0%|          | 16384/36198413 [00:02<18:39, 32323.02it/s]  0%|          | 40960/36198413 [00:02<07:49, 77007.57it/s]  0%|          | 57344/36198413 [00:02<06:43, 89607.48it/s]  0%|          | 81920/36198413 [00:03<05:01, 119767.05it/s]  0%|          | 114688/36198413 [00:03<03:56, 152599.34it/s]  0%|          | 163840/36198413 [00:03<02:42, 222275.67it/s]  1%|          | 212992/36198413 [00:03<02:11, 273848.26it/s]  1%|          | 278528/36198413 [00:03<01:42, 349666.62it/s]  1%|          | 360448/36198413 [00:03<01:17, 462371.88it/s]  1%|1         | 458752/36198413 [00:03<01:00, 591406.78it/s]  2%|1         | 557056/36198413 [00:03<00:51, 688133.77it/s]  2%|1         | 671744/36198413 [00:04<00:44, 803513.81it/s]  2%|2         | 770048/36198413 [00:04<00:42, 841947.28it/s]  3%|3         | 1163264/36198413 [00:04<00:20, 1693191.35it/s]  4%|3         | 1351680/36198413 [00:04<00:20, 1741261.03it/s]  4%|4         | 1548288/36198413 [00:04<00:19, 1786163.17it/s]  5%|5         | 1957888/36198413 [00:04<00:13, 2452854.02it/s]  7%|6         | 2498560/36198413 [00:04<00:10, 3292011.82it/s]  8%|8         | 3055616/36198413 [00:04<00:08, 3949853.36it/s] 10%|#         | 3670016/36198413 [00:04<00:07, 4583807.49it/s] 13%|#2        | 4554752/36198413 [00:04<00:05, 5819449.90it/s] 15%|#5        | 5447680/36198413 [00:05<00:04, 6607979.69it/s] 19%|#8        | 6823936/36198413 [00:05<00:03, 8591582.36it/s] 21%|##1       | 7684096/36198413 [00:06<00:13, 2142600.34it/s] 23%|##2       | 8314880/36198413 [00:07<00:27, 1007129.95it/s] 26%|##5       | 9240576/36198413 [00:08<00:20, 1285360.86it/s] 27%|##6       | 9641984/36198413 [00:09<00:26, 1010487.93it/s] 27%|##7       | 9945088/36198413 [00:10<00:34, 750969.41it/s]  28%|##8       | 10166272/36198413 [00:10<00:41, 630099.71it/s] 41%|####      | 14688256/36198413 [00:10<00:07, 2830472.79it/s] 43%|####2     | 15417344/36198413 [00:11<00:07, 2963507.35it/s] 45%|####4     | 16154624/36198413 [00:11<00:06, 3327812.02it/s] 47%|####6     | 16908288/36198413 [00:11<00:05, 3767762.99it/s] 49%|####8     | 17596416/36198413 [00:11<00:04, 3949530.65it/s] 50%|#####     | 18219008/36198413 [00:11<00:04, 4218719.99it/s] 52%|#####2    | 18866176/36198413 [00:11<00:03, 4599860.17it/s] 54%|#####4    | 19603456/36198413 [00:11<00:03, 5145106.76it/s] 56%|#####6    | 20332544/36198413 [00:11<00:02, 5603360.37it/s] 58%|#####8    | 21086208/36198413 [00:12<00:02, 6034297.34it/s] 60%|######    | 21823488/36198413 [00:12<00:02, 6368175.13it/s] 62%|######2   | 22552576/36198413 [00:12<00:02, 6613459.12it/s] 64%|######4   | 23289856/36198413 [00:12<00:01, 6809962.60it/s] 66%|######6   | 24027136/36198413 [00:12<00:01, 6943040.99it/s] 68%|######8   | 24756224/36198413 [00:12<00:01, 7033305.49it/s] 70%|#######   | 25501696/36198413 [00:12<00:01, 7155229.16it/s] 73%|#######2  | 26247168/36198413 [00:12<00:01, 7197296.08it/s] 75%|#######4  | 26984448/36198413 [00:12<00:01, 7230403.03it/s] 77%|#######6  | 27721728/36198413 [00:12<00:01, 7268431.96it/s] 79%|#######8  | 28459008/36198413 [00:13<00:01, 7252106.76it/s] 81%|########  | 29196288/36198413 [00:13<00:00, 7280980.98it/s] 83%|########2 | 29933568/36198413 [00:13<00:00, 7289065.27it/s] 85%|########4 | 30670848/36198413 [00:13<00:00, 6696855.29it/s] 88%|########7 | 31825920/36198413 [00:13<00:00, 8014183.10it/s] 90%|######### | 32645120/36198413 [00:13<00:00, 7674047.14it/s] 93%|#########2| 33505280/36198413 [00:13<00:00, 7885865.55it/s] 95%|#########4| 34308096/36198413 [00:13<00:00, 7617060.57it/s] 97%|#########7| 35135488/36198413 [00:13<00:00, 7770692.63it/s] 99%|#########9| 35921920/36198413 [00:14<00:00, 7775128.77it/s]36200448it [00:14, 2575224.49it/s]                              
Extracting data/office31/dslr.tgz to data/office31
Downloading webcam
Downloading https://cloud.tsinghua.edu.cn/f/82b24ed2e08f4a3c8888/?dl=1 to data/office31/webcam.tgz
0it [00:00, ?it/s]  0%|          | 0/20607702 [00:02<?, ?it/s]  0%|          | 8192/20607702 [00:02<12:06, 28352.10it/s]  0%|          | 24576/20607702 [00:02<07:17, 47020.78it/s]  0%|          | 40960/20607702 [00:02<04:37, 74067.35it/s]  0%|          | 73728/20607702 [00:03<02:50, 120308.28it/s]  1%|          | 114688/20607702 [00:03<01:55, 176810.93it/s]  1%|          | 139264/20607702 [00:03<01:45, 193341.64it/s]  1%|          | 188416/20607702 [00:03<01:21, 251950.91it/s]  1%|1         | 253952/20607702 [00:03<00:59, 343287.55it/s]  2%|1         | 335872/20607702 [00:03<00:45, 447557.45it/s]  2%|2         | 434176/20607702 [00:03<00:34, 583744.92it/s]  3%|2         | 565248/20607702 [00:03<00:25, 778881.89it/s]  4%|3         | 729088/20607702 [00:03<00:19, 1016819.84it/s]  5%|4         | 942080/20607702 [00:04<00:15, 1307334.81it/s]  6%|5         | 1212416/20607702 [00:04<00:11, 1680059.28it/s]  8%|7         | 1572864/20607702 [00:04<00:08, 2214515.79it/s] 10%|9         | 2015232/20607702 [00:04<00:06, 2826252.80it/s] 12%|#2        | 2572288/20607702 [00:04<00:04, 3613739.97it/s] 16%|#6        | 3301376/20607702 [00:04<00:03, 4681702.75it/s] 20%|##        | 4202496/20607702 [00:04<00:02, 5934307.14it/s] 26%|##5       | 5349376/20607702 [00:04<00:02, 7548908.16it/s] 30%|##9       | 6111232/20607702 [00:04<00:01, 7514359.67it/s] 35%|###4      | 7192576/20607702 [00:04<00:01, 7923116.36it/s] 42%|####2     | 8658944/20607702 [00:05<00:01, 8447584.88it/s] 49%|####9     | 10125312/20607702 [00:05<00:01, 9127228.27it/s] 57%|#####6    | 11689984/20607702 [00:05<00:00, 9409863.75it/s] 63%|######3   | 13049856/20607702 [00:05<00:01, 6705906.73it/s] 78%|#######7  | 15998976/20607702 [00:05<00:00, 10778776.92it/s] 85%|########4 | 17416192/20607702 [00:06<00:00, 9142391.63it/s]  94%|#########3| 19333120/20607702 [00:06<00:00, 8657172.79it/s]20611072it [00:06, 3233604.56it/s]                              
Extracting data/office31/webcam.tgz to data/office31
=> using model 'resnet50'
Downloading: "https://download.pytorch.org/models/resnet50-19c8e357.pth" to /home/daniel/.cache/torch/hub/checkpoints/resnet50-19c8e357.pth
  0%|          | 0.00/97.8M [00:00<?, ?B/s]  3%|2         | 2.87M/97.8M [00:00<00:03, 30.0MB/s]  7%|6         | 6.55M/97.8M [00:00<00:02, 35.1MB/s] 11%|#         | 10.4M/97.8M [00:00<00:02, 37.3MB/s] 15%|#4        | 14.2M/97.8M [00:00<00:02, 38.3MB/s] 18%|#8        | 17.8M/97.8M [00:00<00:02, 35.9MB/s] 22%|##2       | 21.6M/97.8M [00:00<00:02, 37.0MB/s] 26%|##6       | 25.4M/97.8M [00:00<00:01, 38.0MB/s] 30%|##9       | 29.2M/97.8M [00:00<00:01, 38.6MB/s] 34%|###3      | 33.0M/97.8M [00:00<00:01, 38.9MB/s] 38%|###7      | 36.8M/97.8M [00:01<00:01, 39.2MB/s] 42%|####1     | 40.6M/97.8M [00:01<00:01, 39.3MB/s] 45%|####5     | 44.4M/97.8M [00:01<00:01, 39.5MB/s] 49%|####9     | 48.2M/97.8M [00:01<00:01, 37.8MB/s] 53%|#####3    | 51.9M/97.8M [00:01<00:01, 38.1MB/s] 57%|#####6    | 55.5M/97.8M [00:01<00:01, 38.1MB/s] 61%|######    | 59.2M/97.8M [00:01<00:01, 37.9MB/s] 64%|######4   | 63.0M/97.8M [00:01<00:00, 38.4MB/s] 68%|######8   | 66.8M/97.8M [00:01<00:00, 38.8MB/s] 72%|#######2  | 70.5M/97.8M [00:02<00:00, 30.0MB/s] 75%|#######5  | 73.6M/97.8M [00:02<00:00, 27.9MB/s] 78%|#######8  | 76.5M/97.8M [00:02<00:00, 24.9MB/s] 82%|########2 | 80.3M/97.8M [00:02<00:00, 28.3MB/s] 86%|########6 | 84.1M/97.8M [00:02<00:00, 31.2MB/s] 90%|########9 | 87.7M/97.8M [00:02<00:00, 32.9MB/s] 94%|#########3| 91.4M/97.8M [00:02<00:00, 34.6MB/s] 97%|#########7| 95.2M/97.8M [00:02<00:00, 36.0MB/s]100%|##########| 97.8M/97.8M [00:02<00:00, 35.3MB/s]
Traceback (most recent call last):
  File "/home/daniel/exjobb/Transfer-Learning-Library/examples/domain_adaptation/image_classification/dan.py", line 264, in <module>
    main(args)
  File "/home/daniel/exjobb/Transfer-Learning-Library/examples/domain_adaptation/image_classification/dan.py", line 116, in main
    train(train_source_iter, train_target_iter, classifier, mkmmd_loss, optimizer,
  File "/home/daniel/exjobb/Transfer-Learning-Library/examples/domain_adaptation/image_classification/dan.py", line 172, in train
    transfer_loss = mkmmd_loss(f_s, f_t)
  File "/home/daniel/miniconda3/envs/transfer/lib/python3.9/site-packages/torch-1.7.1-py3.9-linux-x86_64.egg/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/daniel/miniconda3/envs/transfer/lib/python3.9/site-packages/tllib-0.4-py3.9.egg/tllib/alignment/dan.py", line 84, in forward
    linear=not args.non_linear
  File "/home/daniel/miniconda3/envs/transfer/lib/python3.9/site-packages/tllib-0.4-py3.9.egg/tllib/alignment/dan.py", line 84, in <listcomp>
    linear=not args.non_linear
  File "/home/daniel/miniconda3/envs/transfer/lib/python3.9/site-packages/torch-1.7.1-py3.9-linux-x86_64.egg/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/daniel/miniconda3/envs/transfer/lib/python3.9/site-packages/tllib-0.4-py3.9.egg/tllib/modules/kernels.py", line 57, in forward
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 6.00 GiB total capacity; 5.24 GiB already allocated; 0 bytes free; 5.30 GiB reserved in total by PyTorch)
